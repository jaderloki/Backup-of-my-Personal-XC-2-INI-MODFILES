[XComGame.X2AIBTBehaviorTree]

+EquivalentAbilities=(KeyName=AHWNivenProtect, EquivalentAbilityName[0]=AHWNivenHeal, EquivalentAbilityName[1]=AHWNivenHealM2)
; Reaction Behaviors

+Behaviors=(BehaviorName=ScamperRoot_AHWNiven, NodeType=Selector, \\
		Child[0]=TryAHWNivenProtect, \\
		Child[1]=NCMoveDefensive, \\
		Child[2]=SkipMove)

; Niven
+Behaviors=(BehaviorName="AHWNiven::CharacterRoot", NodeType=Selector, Child[0]=TryRequiemPodJobs, Child[1]=GenericGreenMovement, Child[2]=AHWNivenRedAlert, Child[3]=GenericAlertHandler)
+Behaviors=(BehaviorName=AHWNivenRedAlert, NodeType=Sequence, Child[0]=IsRedAlert, Child[1]=AHWNivenRedAbilitySelector)
+Behaviors=(BehaviorName=AHWNivenRedAbilitySelector, NodeType=Selector, Child[0]=AHWNivenRedFirstAction, Child[1]=AHWNivenRedLastAction)

+Behaviors=(BehaviorName=AHWNivenRedFirstAction, NodeType=Sequence, Child[0]=NotLastActionPoint, Child[1]=AHWNivenFirstActionSelector)
+Behaviors=(BehaviorName=AHWNivenFirstActionSelector, NodeType=Selector, Child[0]=TryAHWNivenSuppression, Child[1]=AHWNivenAlwaysFallback, Child[2]=NCMoveDefensive, Child[3]=HuntEnemy)
+Behaviors=(BehaviorName=AHWNivenRedLastAction, NodeType=Sequence, Child[0]=IsLastActionPoint, Child[1]=AHWNivenLastActionSelector)
+Behaviors=(BehaviorName=AHWNivenLastActionSelector, NodeType=Selector, Child[0]=TryAHWNivenSuppression, Child[1]=TryAHWNivenProtect, Child[2]=AHWNivenAlwaysFallback, Child[3]=NCMoveDefensive, Child[4]=HuntEnemy)

+Behaviors=(BehaviorName=AHWNivenAlwaysFallback, NodeType=Sequence, Child[0]=AnyLivingEnemyVisible, Child[1]=NoAlliesVisible, Child[2]=FallBackUnsafe)

+Behaviors=(BehaviorName=TryAHWNivenSuppression, NodeType=Sequence, Child[0]=IsAbilityAvailable-AHWNivenSuppression, Child[1]=SelectTargetForAHWNivenSuppression, Child[2]=SelectAbility-AHWNivenSuppression) 
+Behaviors=(BehaviorName=IsAbilityAvailable-AHWNivenSuppression, NodeType=Condition)
+Behaviors=(BehaviorName=SelectTargetForAHWNivenSuppression, NodeType=Sequence, Child[0]=SetTargetStack-AHWNivenSuppression, Child[1]=IterateTargetsForAHWNivenSuppression, Child[2]=HasValidTarget-AHWNivenSuppression)
+Behaviors=(BehaviorName=SetTargetStack-AHWNivenSuppression, NodeType=Action)
+Behaviors=(BehaviorName=IterateTargetsForAHWNivenSuppression, NodeType=RepeatUntilFail, Child[0]=IterateNextTargetForAHWNivenSuppression)
+Behaviors=(BehaviorName=IterateNextTargetForAHWNivenSuppression, NodeType=Sequence, Child[0]=SetNextTarget, Child[1]=SSEvaluateForAHWNivenSuppression, Child[2]=UpdateBestTarget)
+Behaviors=(BehaviorName=SSEvaluateForAHWNivenSuppression, NodeType=Successor, Child[0]=EvaluateForAHWNivenSuppression)
+Behaviors=(BehaviorName=EvaluateForAHWNivenSuppression, NodeType=Sequence, Child[0]=TargetIsNotCivilian, Child[1]=TargetIsEnemy, Child[2]=TargetIsAttackable, Child[3]=AHWNivenSpecialTargetParameterSelector, Child[4]=AvoidBoundAndPanickedTargets, Child[5]=AHWScaleTargetScoreByNotoriety, Child[6]=AddSmallRandomTargetScore)
+Behaviors=(BehaviorName=HasValidTarget-AHWNivenSuppression, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-AHWNivenSuppression, NodeType=Action)

+Behaviors=(BehaviorName=AHWNivenSpecialTargetParameterSelector, NodeType=Selector, Child[0]=ScorePsycheSuppressedTargets, Child[1]=ScoreGrenadierForNivenSuppression, Child[2]=ScoreTemplarForNivenSuppression, Child[3]=ScoreOverwatcherForNivenSuppression, Child[4]=ScoreTargetIfMarked, Child[5]=ScoreIfTarget_HasHighestRank, Child[6]=ScoreNotorietyForNivenSuppression, Child[7]=ScoreIfTarget_HasHighestVisibility, Child[8]=AddToTargetScore_1)

+Behaviors=(BehaviorName=ScoreNotorietyForNivenSuppression, NodeType=Sequence, Child[0]=AHWScaleTargetScoreByNotoriety, Child[1]=AddToTargetScore_1)
+Behaviors=(BehaviorName=ScoreOverwatcherForNivenSuppression, NodeType=Sequence, Child[0]=TargetIsOverwatching, Child[1]=AddToTargetScore_75)
+Behaviors=(BehaviorName=ScoreTemplarForNivenSuppression, NodeType=Sequence, Child[0]=TargetAffectedByEffect-TemplarFocus, Child[1]=AddToTargetScore_125)
+Behaviors=(BehaviorName=ScoreGrenadierForNivenSuppression, NodeType=Sequence, Child[0]=AHWTargetHasGrenadeLauncher, Child[1]=AddToTargetScore_150)
+Behaviors=(BehaviorName=ScorePsycheSuppressedTargets, NodeType=Sequence, Child[0]=TargetAffectedByEffect-AHWNivenSuppression, Child[1]=AddToTargetScore_250)
+Behaviors=(BehaviorName=TargetAffectedByEffect-AHWNivenSuppression, NodeType=Condition)
+Behaviors=(BehaviorName=TargetAffectedByEffect-TemplarFocus, NodeType=Condition)

+Behaviors=(BehaviorName=TryAHWNivenProtect, NodeType=Sequence, Child[0]=IsAbilityAvailable-AHWNivenProtect, Child[1]=SelectTargetForAHWNivenProtect, Child[2]=SelectAbility-AHWNivenProtect) 
+Behaviors=(BehaviorName=IsAbilityAvailable-AHWNivenProtect, NodeType=Condition)
+Behaviors=(BehaviorName=SelectTargetForAHWNivenProtect, NodeType=Sequence, Child[0]=SetTargetStack-AHWNivenProtect, Child[1]=IterateTargetsForAHWNivenProtect, Child[2]=HasValidTarget-AHWNivenProtect)
+Behaviors=(BehaviorName=SetTargetStack-AHWNivenProtect, NodeType=Action)
+Behaviors=(BehaviorName=IterateTargetsForAHWNivenProtect, NodeType=RepeatUntilFail, Child[0]=IterateNextTargetForAHWNivenProtect)
+Behaviors=(BehaviorName=IterateNextTargetForAHWNivenProtect, NodeType=Sequence, Child[0]=SetNextTarget, Child[1]=SSEvaluateForAHWNivenProtect, Child[2]=UpdateBestTarget)
+Behaviors=(BehaviorName=SSEvaluateForAHWNivenProtect, NodeType=Successor, Child[0]=EvaluateForAHWNivenProtect)
+Behaviors=(BehaviorName=EvaluateForAHWNivenProtect, NodeType=Sequence, Child[0]=TargetIsNotPriest, Child[1]=TargetScoreByVisibleXComDist-1, Child[2]=ScoreIfTarget_MaxHP, Child[3]=ScoreByHP)
+Behaviors=(BehaviorName=HasValidTarget-AHWNivenProtect, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-AHWNivenProtect, NodeType=Action)

+Behaviors=(BehaviorName=TryAHWNivenProtect, NodeType=Sequence, Child[0]=IsAbilityAvailable-AHWNivenProtect, Child[1]=SelectTargetForAHWNivenProtect, Child[2]=SelectAbility-AHWNivenProtect) 
+Behaviors=(BehaviorName=IsAbilityAvailable-AHWNivenProtect, NodeType=Condition)
+Behaviors=(BehaviorName=SelectTargetForAHWNivenProtect, NodeType=Sequence, Child[0]=SetTargetStack-AHWNivenProtect, Child[1]=IterateTargetsForAHWNivenProtect, Child[2]=HasValidTarget-AHWNivenProtect)
+Behaviors=(BehaviorName=SetTargetStack-AHWNivenProtect, NodeType=Action)
+Behaviors=(BehaviorName=IterateTargetsForAHWNivenProtect, NodeType=RepeatUntilFail, Child[0]=IterateNextTargetForAHWNivenProtect)
+Behaviors=(BehaviorName=IterateNextTargetForAHWNivenProtect, NodeType=Sequence, Child[0]=SetNextTarget, Child[1]=SSEvaluateForAHWNivenProtect, Child[2]=UpdateBestTarget)
+Behaviors=(BehaviorName=SSEvaluateForAHWNivenProtect, NodeType=Successor, Child[0]=EvaluateForAHWNivenProtect)
+Behaviors=(BehaviorName=EvaluateForAHWNivenProtect, NodeType=Sequence, Child[0]=TargetIsNotPriest, Child[1]=TargetScoreByVisibleXComDist-1, Child[2]=ScoreIfTarget_MaxHP, Child[3]=ScoreByHP, Child[4]=ScoreForNivenGuardian)
+Behaviors=(BehaviorName=HasValidTarget-AHWNivenProtect, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-AHWNivenProtect, NodeType=Action)

+Behaviors=(BehaviorName=ScoreForNivenGuardian, NodeType=Selector, Child[0]=ScoreTargetIsProtectableChosen, Child[1]=AddToTargetScore_0)
+Behaviors=(BehaviorName=ScoreTargetIsProtectableChosen, NodeType=Sequence, Child[0]=TargetIsChosen, Child[1]=AddToTargetScore_50)