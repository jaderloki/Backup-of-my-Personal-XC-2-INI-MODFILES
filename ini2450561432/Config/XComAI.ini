[XComGame.X2AIBTBehaviorTree]

; ----------------------------------------------------------------------------------------------------------
; ------------------------------------------ LWDrone -------------------------------------------------------
; ----------------------------------------------------------------------------------------------------------
+Behaviors=(BehaviorName=MECRedFallbackAction, NodeType=Selector, Child[0]=RandOverwatch75, Child[1]=SkipMove)

; Select attack if in range, otherwise defend
+Behaviors=(BehaviorName=AlDroneRoot, NodeType=Selector, Child[0]=TryJob, Child[1]=GenericGreenMovement, Child[2]=LWDroneRedAlert, Child[3]=GenericAlertHandler)

+Behaviors=(BehaviorName=LWDroneRedAlert, NodeType=Sequence, Child[0]=IsRedAlert, Child[1]=LWDroneRedAbilitySelector)
+Behaviors=(BehaviorName=LWDroneRedAbilitySelector, NodeType=Selector, Child[0]=MimicBeaconBehavior, Child[1]=LWDroneRedFirstAction, Child[2]=LWDroneRedLastAction, Child[3]=MECRedFallbackAction)

+Behaviors=(BehaviorName=LWDroneRedFirstAction, NodeType=Sequence, Child[0]=NotLastActionPoint, Child[1]=LWDroneRedFirstActionSelector)
+Behaviors=(BehaviorName=LWDroneRedFirstActionSelector, NodeType=Selector, \\
	Child[0]=TryHighPriorityShock, \\
	Child[1]=TryMoveForDroneRepair, \\
	Child[2]=TryMoveForDroneShield, \\
	Child[3]=TryMoveForDroneMeleeStun, \\
	Child[4]=TryDroneFlankingMove, \\
	Child[5]=TryDroneRegularMove, \\
	Child[6]=HuntEnemyUnsafe)


+Behaviors=(BehaviorName=LWDroneRedLastAction, NodeType=Sequence, Child[0]=IsLastActionPoint, Child[1]=LWDroneRedLastActionSelector)
+Behaviors=(BehaviorName=LWDroneRedLastActionSelector, NodeType=Selector, \\
	Child[0]=TryMeleeStun, \\
	Child[1]=TryHighPriorityShock, \\
	Child[2]=TryRepairOrShock, \\
	Child[3]=ShockIfAvailable, \\
	Child[4]=HuntEnemyUnsafe, \\
	Child[5]=TryDroneRegularMove)


+Behaviors=(BehaviorName=TryDroneFlankingMove, NodeType=Sequence, Child[0]=IsMyJob-Soldier, Child[1]=IsAbilityAvailable-StandardMove, Child[2]=ResetDestinationSearch, Child[3]=RestrictToFlanking, Child[4]=SetNoCoverMovement, Child[5]=RestrictToAbilityRange-LWDroneShock, Child[6]=SelectAbility-StandardMove)
+Behaviors=(BehaviorName=TryDroneRegularMove, NodeType=Sequence, Child[0]=IsAbilityAvailable-StandardMove, Child[1]=ResetDestinationSearch, Child[2]=SetNoCoverMovement, Child[3]=RestrictToAbilityRange-LWDroneShock, Child[4]=SelectAbility-StandardMove)

+Behaviors=(BehaviorName=TryHighPriorityShock, NodeType=Sequence, Child[0]=IsAbilityAvailable-LWDroneShock, Child[1]=HaveHighPriorityShockTarget, Child[2]=ShockIfAvailable)
+Behaviors=(BehaviorName=HaveHighPriorityShockTarget, NodeType=Sequence, Child[0]=SetTargetStack-LWDroneShock, Child[1]=FindHighPriorityTarget, Child[2]=HasValidTarget-LWDroneShock)

+Behaviors=(BehaviorName=TryMeleeStun, NodeType=Sequence, Child[0]=IsAbilityAvailable-LWDroneMeleeStun, Child[1]=SelectTargetForMeleeStun, Child[2]=SelectAbility-LWDroneMeleeStun)
+Behaviors=(BehaviorName=SelectTargetForMeleeStun, NodeType=Sequence, Child[0]=SetTargetStack-LWDroneMeleeStun, Child[1]=GenericSelectBestTarget, Child[2]=HasValidTarget-LWDroneMeleeStun)

+Behaviors=(BehaviorName=TryRepairOrShock, NodeType=RandSelector, Child[0]=DroneRepairOrShield, Param[0]=70, Child[1]=ShockIfAvailable, Param[1]=30)

+Behaviors=(BehaviorName=ShockIfAvailable, NodeType=Sequence, Child[0]=IsAbilityAvailable-LWDroneShock, Child[1]=SelectTargetForShock, Child[2]=SelectAbility-LWDroneShock)
+Behaviors=(BehaviorName=SelectTargetForShock, NodeType=Sequence, Child[0]=SetTargetStack-LWDroneShock, Child[1]=GenericSelectBestTarget, Child[2]=HasValidTarget-LWDroneShock)


+Behaviors=(BehaviorName=DroneRepairOrShield, NodeType=Selector, Child[0]=DroneShieldIfAvailable, Child[1]=DroneRepairIfAvailable)

+Behaviors=(BehaviorName=DroneShieldIfAvailable, NodeType=Sequence, Child[0]=IsAbilityAvailable-AL_DroneShield, Child[1]=SelectTargetForDroneShield, Child[2]=SelectAbility-AL_DroneShield)

+Behaviors=(BehaviorName=SelectTargetForDroneShield, NodeType=Sequence, Child[0]=SetTargetStack-AL_DroneShield, Child[1]=SelectBestTargetForDroneShield, Child[2]=HasValidTarget-AL_DroneShield)
+Behaviors=(BehaviorName=SelectBestTargetForDroneShield, NodeType=RepeatUntilFail, Child[0]=EvaluateTargetsDroneShield)
+Behaviors=(BehaviorName=EvaluateTargetsDroneShield, NodeType=Sequence, Child[0]=SetNextTarget, Child[1]=TargetScoreHighestSoldierRank, Child[2]=TargetScoreHealth, Child[3]=TargetScoreInvalidateCivilians, Child[4]=UpdateBestTarget)





+Behaviors=(BehaviorName=DroneRepairIfAvailable, NodeType=Sequence, Child[0]=IsAbilityAvailable-LWDroneRepair, Child[1]=SelectTargetForDroneRepair, Child[2]=SelectAbility-LWDroneRepair)

+Behaviors=(BehaviorName=TryMoveForDroneRepair, NodeType=Sequence, Child[0]=IsMyJob-Support, Child[1]=SafeToMove, Child[2]=IsAbilityReady-LWDroneRepair, Child[3]=SelectTargetForDroneRepair, Child[4]=MoveStandardIfFirstAbility-LWDroneRepair)
+Behaviors=(BehaviorName=MoveStandardIfFirstAbility-LWDroneRepair, NodeType=Sequence, Child[0]=IsAbilityAvailable-StandardMove, Child[1]=NotLastActionPoint, Child[2]=FindDroneRepairDestination, Child[3]=SelectAbility-StandardMove)
+Behaviors=(BehaviorName=FindDroneRepairDestination, NodeType=Sequence, Child[0]=ResetDestinationSearch, Child[1]=RestrictToPotentialTargetRange-LWDroneRepair, Child[2]=FindRestrictedDestination-MWP_Fanatic)

+Behaviors=(BehaviorName=SelectTargetForDroneRepair, NodeType=Sequence, Child[0]=SetTargetStack-LWDroneRepair, Child[1]=SelectBestTargetForDroneRepair, Child[2]=HasValidTarget-LWDroneRepair)
+Behaviors=(BehaviorName=SelectBestTargetForDroneRepair, NodeType=RepeatUntilFail, Child[0]=EvaluateTargetsDroneRepair)
+Behaviors=(BehaviorName=EvaluateTargetsDroneRepair, NodeType=Sequence, Child[0]=SetNextTarget, Child[1]=TargetScoreHighestSoldierRank, Child[2]=TargetScoreHealth, Child[3]=TargetScoreInvalidateCivilians, Child[4]=UpdateBestTarget)

+Behaviors=(BehaviorName=TryMoveForDroneShield, NodeType=Sequence, Child[0]=IsMyJob-Support, Child[1]=SafeToMove, Child[2]=IsAbilityReady-AL_DroneShield, Child[3]=SelectTargetForDroneShield, Child[4]=MoveStandardIfFirstAbility-AL_DroneShield)
+Behaviors=(BehaviorName=MoveStandardIfFirstAbility-AL_DroneShield, NodeType=Sequence, Child[0]=IsAbilityAvailable-StandardMove, Child[1]=NotLastActionPoint, Child[2]=FindDroneShieldDestination, Child[3]=SelectAbility-StandardMove)
+Behaviors=(BehaviorName=FindDroneShieldDestination, NodeType=Sequence, Child[0]=ResetDestinationSearch, Child[1]=RestrictToPotentialTargetRange-AL_DroneShield, Child[2]=FindRestrictedDestination-MWP_Fanatic)

+Behaviors=(BehaviorName=FindHighPriorityTarget, NodeType=RepeatUntilFail, Child[0]=NotHighPriorityEvaluateTarget)
+Behaviors=(BehaviorName=NotHighPriorityEvaluateTarget, NodeType=Sequence, Child[0]=SetNextTarget, Child[1]=TargetIsNotHighPriority)
+Behaviors=(BehaviorName=TargetIsNotHighPriority, NodeType=Inverter, Child[0]=TargetIsHighPriority)
+Behaviors=(BehaviorName=TargetIsHighPriority, NodeType=Sequence, Child[0]=TargetIsNotCivilian, Child[1]=TargetKillableOrFlanked, Child[2]=AddToTargetScore_1000, Child[3]=UpdateBestTarget)
+Behaviors=(BehaviorName=TargetKillableOrFlanked, NodeType=Selector, Child[0]=TargetIsKillable,  Child[1]=IsFlankingTarget)


+Behaviors=(BehaviorName=TryMoveForDroneMeleeStun, NodeType=Sequence, Child[0]=IsMyJob-Aggressor, Child[1]=IsAbilityReady-LWDroneMeleeStun, Child[2]=SelectTargetForDroneMeleeStun, Child[3]=MoveStandardIfFirstAbility-LWDroneMeleeStun)
+Behaviors=(BehaviorName=MoveStandardIfFirstAbility-LWDroneMeleeStun, NodeType=Sequence, Child[0]=IsAbilityAvailable-StandardMove, Child[1]=NotLastActionPoint, Child[2]=FindDroneMeleeStunDestination, Child[3]=SelectAbility-StandardMove)
+Behaviors=(BehaviorName=FindDroneMeleeStunDestination, NodeType=Sequence, Child[0]=ResetDestinationSearch, Child[1]=RestrictToPotentialTargetRange-LWDroneMeleeStun, Child[2]=FindRestrictedDestination-MWP_Fanatic)

+Behaviors=(BehaviorName=SelectTargetForDroneMeleeStun, NodeType=Sequence, Child[0]=SetTargetStack-LWDroneMeleeStun, Child[1]=SelectBestTargetForDroneMeleeStun, Child[2]=HasValidTarget-LWDroneMeleeStun)
+Behaviors=(BehaviorName=SelectBestTargetForDroneMeleeStun, NodeType=RepeatUntilFail, Child[0]=EvaluateTargetsDroneMeleeStun)
+Behaviors=(BehaviorName=EvaluateTargetsDroneMeleeStun, NodeType=Sequence, Child[0]=SetNextTarget, Child[1]=TargetScoreHighestSoldierRank, Child[2]=TargetScoreHealth, Child[3]=TargetScoreInvalidateCivilians, Child[4]=UpdateBestTarget)


+Behaviors=(BehaviorName=IsAbilityAvailable-LWDroneShock, NodeType=Condition)
+Behaviors=(BehaviorName=IsAbilityReady-LWDroneShock, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-LWDroneShock, NodeType=Action)
+Behaviors=(BehaviorName=HasValidTarget-LWDroneShock, NodeType=Condition)
+Behaviors=(BehaviorName=SetTargetStack-LWDroneShock, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToAbilityRange-LWDroneShock, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToPotentialTargetRange-LWDroneShock, NodeType=Action)

+Behaviors=(BehaviorName=IsAbilityAvailable-LWDroneMeleeStun, NodeType=Condition)
+Behaviors=(BehaviorName=IsAbilityReady-LWDroneMeleeStun, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-LWDroneMeleeStun, NodeType=Action)
+Behaviors=(BehaviorName=HasValidTarget-LWDroneMeleeStun, NodeType=Condition)
+Behaviors=(BehaviorName=SetTargetStack-LWDroneMeleeStun, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToAbilityRange-LWDroneMeleeStun, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToPotentialTargetRange-LWDroneMeleeStun, NodeType=Action)

+Behaviors=(BehaviorName=IsAbilityAvailable-LWDroneRepair, NodeType=Condition)
+Behaviors=(BehaviorName=IsAbilityReady-LWDroneRepair, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-LWDroneRepair, NodeType=Action)
+Behaviors=(BehaviorName=HasValidTarget-LWDroneRepair, NodeType=Condition)
+Behaviors=(BehaviorName=SetTargetStack-LWDroneRepair, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToAbilityRange-LWDroneRepair, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToPotentialTargetRange-LWDroneRepair, NodeType=Action)

+Behaviors=(BehaviorName=IsAbilityAvailable-AL_DroneShield, NodeType=Condition)
+Behaviors=(BehaviorName=IsAbilityReady-AL_DroneShield, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-AL_DroneShield, NodeType=Action)
+Behaviors=(BehaviorName=HasValidTarget-AL_DroneShield, NodeType=Condition)
+Behaviors=(BehaviorName=SetTargetStack-AL_DroneShield, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToAbilityRange-AL_DroneShield, NodeType=Action)
+Behaviors=(BehaviorName=RestrictToPotentialTargetRange-AL_DroneShield, NodeType=Action)


; -------------------- Advent Combat Bot ---------------------------------------------

+Behaviors=(BehaviorName="FeralBot::CharacterRoot", NodeType=Selector, Child[0]=TryJob, Child[1]=GenericGreenMovement, Child[2]=FeralBotRedAlert, Child[3]=GenericAlertHandler)
+Behaviors=(BehaviorName=FeralBotRedAlert, NodeType=Sequence, Child[0]=IsRedAlert, Child[1]=FeralBotRedAbilitySelector)
+Behaviors=(BehaviorName=FeralBotRedAbilitySelector, NodeType=Selector, Child[0]=MimicBeaconBehavior, Child[1]=FeralBotRedFirstAction, Child[2]=FeralBotRedLastAction)

+Behaviors=(BehaviorName=FeralBotRedFirstAction, NodeType=Sequence, Child[0]=NotLastActionPoint, Child[1]=FeralBotFirstActionSelector)
+Behaviors=(BehaviorName=FeralBotFirstActionSelector, NodeType=Selector, \\
	Child[0]=TryOverloadBranch, \\
	Child[1]=SelectMove_JobOrDefensive, \\
	Child[2]=HuntEnemy, \\
	Child[3]=TryMecDroneDeploy, \\
	Child[4]=TryShootOrReloadOrOverwatch)

+Behaviors=(BehaviorName=FeralBotRedLastAction, NodeType=Sequence, Child[0]=IsLastActionPoint, Child[1]=FeralBotRedLastActionSelector)
+Behaviors=(BehaviorName=FeralBotRedLastActionSelector, NodeType=Selector,\\
	Child[0]=TryOverloadBranch, \\
	Child[1]=TryMecDroneDeploy, \\
	Child[2]=ShootOrSuppressIfNoGoodShot, \\
	Child[3]=HuntEnemy, \\
	Child[4]=SelectNCMove_JobOrFanatic, \\
	Child[5]=TryShootOrReloadOrOverwatch)



; ----------------Aim Boost --------------------------------------------
+Behaviors=(BehaviorName=TryMecDroneDeploy, NodeType=Sequence, Child[0]=IsAbilityAvailable-ADV115_DroneDeploy, Child[1]=SelectAbility-ADV115_DroneDeploy)
+Behaviors=(BehaviorName=IsAbilityAvailable-ADV115_DroneDeploy, NodeType=Condition)
+Behaviors=(BehaviorName=SelectAbility-ADV115_DroneDeploy, NodeType=Action)